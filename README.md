**The Economics of Density: Evidence from the Berlin Wall**

**Toolkit**

Â© Gabriel M. Ahlfeldt, S. J. Redding, D. Sturm, N. Wolf

Version 0.91, 2024

**General Instructions**

This toolkit complements the original replication directory for Ahlfeldt, Redding, Sturm, Wolf (2015). The toolkit does not cover all stages of the analysis presented in the article. Instead, it covers a subset of codes that are crucial for the quantification and simulation of the model using 2006 data. Detailed comments have been added to all scripts to provide intuition and closer links to the model described in the article and supplement. Some codes have been processed to make them more accessible, reducing the memory requirements and facilitating faster execution on desktop computers. For the same reason, we use trimmed versions of the datasets, which contain variables that are essential for the purpose of this teaching directory. Any data set or program that has been substantively altered (other than adding comments) is marked by a "_TD" suffix in the filename.

A program has been added to rescale productivities and amenities recovered using the sequential procedure (using files in the section6/calibration folder) so that they are amenable to the equilibrium solvers used in the counterfactual folders of Sections 6 and 7. Some other smaller programs have been added to make the structure of the code more accessible. A META script has been added from which all other scripts are called. Codes have been updated so that the root directory of this toolkit has to be defined only once in the META script. A MAPIT program has been added that allows for immediate inspection of the outputs as they are being generated by the code (alongside shapefiles indexed in the same way as the MATLAB data). Finally, throughout the various steps of the calibration and simulation, illustrative explorations of recovered productivities and amenities, solved wages, and some simple counterfactuals have been added for didactic purposes.

Before you can start, you **need to install the following MATLAB toolboxes:**

- Global optimization toolbox
- Mapping toolbox
- Statistics and machine learning toolbox

To install a MATLAB toolbox, open MATLAB and go to the 'Home' tab. Click on 'Add-Ons' in the menu. From there, browse or search for the toolbox you want to install. Click on the toolbox to view its details. Then, proceed by clicking 'Install.' Follow the on-screen instructions, which will include accepting the license agreement and selecting the installation path. After the installation is complete, the toolbox will be ready to use. Make sure you have the appropriate licenses for the toolbox you've selected.

**You must also download three large files from external URLs** indicated in the file directory below.

Note that due to large matrices, the execution of this teaching directory is memory-intensive. Even with large internal memory (RAM), you may receive out-of-memory error messages. To avoid this, ensure you **assign plenty of virtual memory** (e.g., 32GB) on your system, preferably on a solid-state drive. Using virtual memory will increase computational time, but it will at least ensure that the codes execute successfully.

**How to Use the Toolkit**

The toolkit is designed as a didactic journey through the codes essential for the quantification and the simulation of the model. The aim is to convey how to quantify the model and conduct simple counterfactuals.

Once you are set up, execute the codes in the order in which they are being called by `META.m`. When you use the toolkit for the first time, it is important that you execute the scripts exactly in the order outlined by `META.m` as intermediate inputs will be generated that will be used at later stages. There are also didactic reasons for proceeding in the given order since the structure broadly follows the use of the model in the paper and codes become progressively more complex. For the best learning experience, we recommend that you open the scripts and go through the code line by line (instead of calling scripts from `META.m`). Plenty of comments have been added to refer to the relevant equations in the paper. It will likely be beneficial to triangulate between the code, the pseudo codes summarized in the course codebook, and the paper and the supplement to understand how the code implements the model.

Throughout the quantification of the model, we use the `MAPIT` program to illustrate selected variables recovered using the structure of the model. You can use `MAPIT` to conveniently plot any model input or output at any stage of the analysis to develop your intuition for the various endogenous and exogenous objects. Due to the granularity of the data, `MAPIT` is slow. If you want to experiment with the code and reduce the computational time, you may find it convenient to outcomment the use of `MAPIT`.

After recovering the unobserved exogenous location characteristics, we use various solution algorithms to solve for the spatial equilibrium. For illustrative purposes, we perform two simple counterfactuals. First, we implement a ban of private cars by setting bilateral travel times to those that arise when using public transport (this counterfactual is also performed in the paper). Second, we increase the fundamental productivity within the boundaries of former East Berlin. For each counterfactual, we compare the effects on workplace employment, residence employment, wages and floor space prices between the cases with exogenous productivity and amenity and endogenous agglomeration forces. We provide a similar comparison for the closed-city and open city-case. You can use `MAPIT` to inspect the effects on any other endogenous outcome and execute similar counterfactuals by changing other primitives of the model. The toolkit will hopefully be sufficiently transparent for you to conveniently run your own counterfactuals.

When using the toolkit in your work, please cite Ahlfeldt, Redding, Sturm, Wolf (2015)

## MATLAB Files and Data Folders

| Directory | File | Description | Additional Information |
| --- | --- | --- | --- |
| `matlab/data/input` | | Folder containing required data inputs to execute this teaching directory | |
| `matlab/data/input` | `prepdata_big_TD86.mat` | MATLAB file containing 1986 variable generated using `matlab/prepdata_TD86.m` code. | This is a large data set, you need to download it to your machine. [Download](#) |
| `matlab/data/input` | `prepdata_big_TD.mat` | MATLAB file containing 2006 variable generated using `matlab/prepdata_TD.m` code. | This is a large data set, you need to download it to your machine. [Download](#) |
| `matlab/data/input` | `ttpublic_2006_ren.mat` | MATLAB file generated by `prepdata_TD06ftpub.m` containing travel times without cars used for counterfactuals. | This is a large data set, you need to download it to your machine. [Download](#) |
| `matlab/data/input` | `roptimis_all.mat` | MATLAB file containing parameter values estimated using the GMM procedure in Section 7. | |
| `matlab/data/output` | | Folder containing data files generated by the scripts in this toolkit. | Will be populated while you execute the file. |


